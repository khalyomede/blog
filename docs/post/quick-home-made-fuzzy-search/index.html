<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Khalyomede - Khalyomede</title><meta name="gridsome:hash" content="3e98125a0a4072cde816a521b2aa372d32911504"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.21"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/blog/assets/static/favicon.ce0531f.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/blog/assets/static/favicon.ac8d93a.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/blog/assets/static/favicon.b9532cc.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/blog/assets/static/favicon.f22e9f3.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/blog/assets/static/favicon.62d22cb.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/blog/assets/static/favicon.1539b60.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/blog/assets/static/favicon.dc0cdc5.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/blog/assets/static/favicon.7b22250.9bb7ffafafc09ac851d81afb65b8ef59.png"><link rel="preload" href="/blog/assets/css/0.styles.d144c95d.css" as="style"><link rel="preload" href="/blog/assets/js/app.d4d42d36.js" as="script"><link rel="preload" href="/blog/assets/js/page--src-templates-post-vue.50442e6e.js" as="script"><link rel="preload" href="/blog/assets/js/vue-remark--posts-quick-home-made-fuzzy-search-md.7b89a71c.js" as="script"><link rel="prefetch" href="/blog/assets/js/page--node-modules-gridsome-app-pages-404-vue.c17862a2.js"><link rel="prefetch" href="/blog/assets/js/page--src-pages-about-vue.61b01723.js"><link rel="prefetch" href="/blog/assets/js/page--src-pages-index-vue.9654c1ee.js"><link rel="prefetch" href="/blog/assets/js/vue-remark--posts-decoupled-programing-md.6e116292.js"><link rel="prefetch" href="/blog/assets/js/vue-remark--posts-when-to-use-sql-indxes-md.d1b9c1b0.js"><link rel="stylesheet" href="/blog/assets/css/0.styles.d144c95d.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <div data-server-rendered="true" id="app" class="layout"><header class="header"><strong><a href="/blog/" class="active">Khalyomede</a></strong><nav class="nav"><a href="/blog/" class="nav__link hover:underline active">Home</a><a href="/blog/about/" class="nav__link hover:underline">About</a></nav></header><h1 class="text-3xl mb-4">Quick home made fuzzy search</h1><div><p class="mb-2">Lot of occasion presented to me where I have two choice: either take this package, learn, install, implement, check for advanced usage, and ultimately spend some time just for a small fuzzy search dependent component (like a home page search), or just roll my own.</p><p class="mb-2">Let's be honest, fuzzy search is one of these algorithm that you are tempted to think:</p><blockquote><p class="block text-right text-gray-500 text-lg my-4">That's just an SQL like query!</p></blockquote><p class="mb-2">It is, or at least it can be in its easiest form possible. Let me show you. These examples will feature Laravel because I know this framework well.</p><h2 id="level-1-basic-search" class="mb-4 mt-2 text-2xl"><a href="#level-1-basic-search" aria-hidden="true" class="text-blue-600 hover:underline"><span class="icon icon-link"></span></a>Level 1: basic search</h2><p class="mb-2">Take the search term, and perform a like in SQL. Simple, working, no complexity. Ideal for simple things.</p><pre class="language-php"><code class="language-php"><span class="token comment">// app/Http/Controllers/SearchController.php</span>
<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>Controller</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Requests<span class="token punctuation">\</span>SearchRequest</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Post</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>View<span class="token punctuation">\</span>View</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">SearchController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span>
<span class="token punctuation">{</span>
	<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">search</span><span class="token punctuation">(</span>SearchRequest <span class="token variable">$request</span><span class="token punctuation">)</span><span class="token punctuation">:</span> View
	<span class="token punctuation">{</span>
		<span class="token variable">$term</span> <span class="token operator">=</span> <span class="token variable">$request</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">term</span><span class="token punctuation">;</span>
		<span class="token variable">$posts</span> <span class="token operator">=</span> <span class="token scope">Post<span class="token punctuation">::</span></span><span class="token function">where</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;title&quot;</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">&quot;like&quot;</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">&quot;%<span class="token interpolation"><span class="token variable">$term</span></span>%&quot;</span><span class="token punctuation">)</span>
			<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">orWhere</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;excerpt&quot;</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">&quot;like&quot;</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">&quot;%<span class="token interpolation"><span class="token variable">$term</span></span>%&quot;</span><span class="token punctuation">)</span>
			<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">orWhere</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;content&quot;</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">&quot;like&quot;</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">&quot;%<span class="token interpolation"><span class="token variable">$term</span></span>%&quot;</span><span class="token punctuation">)</span>
			<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">return</span> <span class="token function">view</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;search&quot;</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">with</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;posts&quot;</span><span class="token punctuation">,</span> <span class="token variable">$posts</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h2 id="level-2-vscode-command-palette-search-like" class="mb-4 mt-2 text-2xl"><a href="#level-2-vscode-command-palette-search-like" aria-hidden="true" class="text-blue-600 hover:underline"><span class="icon icon-link"></span></a>Level 2: VSCode Command Palette search-like</h2><p class="mb-2">If you are on VSCode on Sublim Text, you might use this trick where you write this:</p><pre class="language-text"><code class="language-text">aphtcontsea</code></pre><p class="mb-2">Which is the concatenation of app-http-controller-search, and VSCode is correctly finding your file <code>Controllers/SearchController.php</code>.</p><p class="mb-2">This is because the search algorithm is actually splitting each characters, and include a wildcard placeholder to say &quot;between each of the characters of the search, you might found anything, nevermind, match it.</p><p class="mb-2">This means you don't even have to write these &quot;/&quot;, because the regular expression is expecting them.</p><p class="mb-2">Check it by yourself on this <a href="https://regex101.com/r/ydPJcj/1" target="_blank" rel="nofollow noopener noreferrer" class="text-blue-600 hover:underline">regex101.com</a> example.</p><p class="mb-2">Here is a suggested implementation:</p><pre class="language-php"><code class="language-php"><span class="token comment">// app/Http/Controllers/SearchController.php</span>
<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>Controller</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Requests<span class="token punctuation">\</span>SearchRequest</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Post</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>View<span class="token punctuation">\</span>View</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">SearchController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span>
<span class="token punctuation">{</span>
	<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">search</span><span class="token punctuation">(</span>SearchRequest <span class="token variable">$request</span><span class="token punctuation">)</span><span class="token punctuation">:</span> View
	<span class="token punctuation">{</span>
		<span class="token variable">$characters</span> <span class="token operator">=</span> <span class="token function">str_split</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">term</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token variable">$search</span> <span class="token operator">=</span> <span class="token function">array_map</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>string <span class="token variable">$character</span><span class="token punctuation">)</span><span class="token punctuation">:</span> string <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token double-quoted-string string">&quot;%<span class="token interpolation"><span class="token variable">$character</span></span>%&quot;</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token variable">$characters</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token variable">$posts</span> <span class="token operator">=</span> <span class="token scope">Post<span class="token punctuation">::</span></span><span class="token function">where</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;title&quot;</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">&quot;like&quot;</span><span class="token punctuation">,</span> <span class="token variable">$search</span><span class="token punctuation">)</span>
			<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">orWhere</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;excerpt&quot;</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">&quot;like&quot;</span><span class="token punctuation">,</span> <span class="token variable">$search</span><span class="token punctuation">)</span>
			<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">orWhere</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;content&quot;</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">&quot;like&quot;</span><span class="token punctuation">,</span> <span class="token variable">$search</span><span class="token punctuation">)</span>
			<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">return</span> <span class="token function">view</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;search&quot;</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">with</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;posts&quot;</span><span class="token punctuation">,</span> <span class="token variable">$posts</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><p class="mb-2">Which would return the following inside <code>$search</code> if you type <code>blog</code>:</p><pre class="language-text"><code class="language-text">%b%%l%%o%%g%</code></pre><p class="mb-2">Extra <code>%</code> are not a problem, just redundant. With a few little effort, we have made something good enough.</p><h2 id="when-using-fuzzy-search" class="mb-4 mt-2 text-2xl"><a href="#when-using-fuzzy-search" aria-hidden="true" class="text-blue-600 hover:underline"><span class="icon icon-link"></span></a>When using fuzzy search</h2><p class="mb-2">What we did is closer to primitive search than real fuzzy search.</p><p class="mb-2">Fuzzy search works by mutating the search term until it find similarities with an existing word, like trying to removing some characters until finding an existing word.</p><p class="mb-2">This have the advantage of finding near match, something that we can't find with the examples above. If you made a typo to <code>blog</code>, like <code>bkog</code>, it will no longer match, when fuzzy search would. Try changing a letter in the <a href="https://regex101.com/r/ydPJcj/1" target="_blank" rel="nofollow noopener noreferrer" class="text-blue-600 hover:underline">regexp101.com</a> example to see it in action.</p><p class="mb-2">Other advantage, fuzzy search provides a result confidence ratio for each results, so you can order search results by this new variable (which we can't do with the examples above).</p><p class="mb-2">Implementing fuzzy search involves a lot of time finding the best approach, so this should come as an upgrade of an existing simple search algorithm.</p><p class="mb-2">I would not advise to start with fuzzy search because this is also a cost depending how it is implemented (you might have to first convert every of your potental results to fit the library, which is something you would not have to do with pure SQL).</p></div></div>
    <script>window.__INITIAL_STATE__={"data":{"post":{"title":"Quick home made fuzzy search","excerpt":"No time to implement a fuzzy search library? Me too."}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/blog/assets/js/app.d4d42d36.js" defer></script><script src="/blog/assets/js/page--src-templates-post-vue.50442e6e.js" defer></script><script src="/blog/assets/js/vue-remark--posts-quick-home-made-fuzzy-search-md.7b89a71c.js" defer></script>
  </body>
</html>
